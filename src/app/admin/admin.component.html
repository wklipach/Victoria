<div class="container">

  <app-mainmenu></app-mainmenu>


  <form [formGroup]="adminForm">
    <div class="row">
      <div class="col-6">

        <h4 class="alert-primary py-2 pl-2">Редактирование отделений</h4>

        <div class="card card-body mt-4 pt-0">
          <div class="btn-group-justified">

            <!-- Кнопка добавления отделения -->
            <button class="btn btn-primary my-2 mr-4 w-1" data-toggle="collapse" title="добавить отделение" href="#collapse1" aria-expanded="false" aria-controls="collapse1">
              <i class="fa fa-plus"></i>
            </button>

            <!-- Кнопка редактирования отделения -->
            <button class="btn btn-primary my-2 mr-4 w-1" (click)="changeBranch()"  data-toggle="collapse"  title="изменить название" href="#collapseCH" aria-expanded="false" aria-controls="collapse1">
              <i class="fa fa-edit"></i>
            </button>

            <!-- Кнопка модального окна удаления отделения -->
            <button type="button" class="btn btn-danger my-2 mr-4 w-1"  title="удалить отделение" data-toggle="modal" data-target="#collapseDeleteBranch">
              <i class="fa fa-trash"></i>
            </button>


          </div>

          <div class="collapse" id="collapse1">
            <div class="card card-body my-2">
              <div class="input-group">
                <input formControlName="inputNewBranch" type="text" class="form-control" placeholder="Введите название нового отделения" aria-label="" aria-describedby="basic-addon1">
                <div class="input-group-append">
                  <button class="btn btn-success" (click)="newBranch()" type="button">Сохранить</button>
                </div>
              </div>
            </div>
          </div>

          <div class="collapse" id="collapseCH">

            <div class="card card-body">

              <div class="input-group">

                <input formControlName="inputChangeBranch" type="text" class="form-control" placeholder="" aria-label="" aria-describedby="basic-addon1">

                <div class="input-group-append">

                  <button class="btn btn-success" (click)="OnChangeBranch()" type="button">Изменить</button>

                </div>

              </div>

            </div>

          </div>


          <ul class="list-group">
            <li [class.selected] = "bl === selectedBL" class="list-group-item"  (click)="mu(bl)"  *ngFor="let bl of branchList">{{bl.name }}</li>
          </ul>

          <!-- Модальное окно удаления отделения -->
          <div class="modal fade" id="collapseDeleteBranch" tabindex="-1" role="dialog" aria-labelledby="modalCenterTitle" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="modalLongTitle">Удаление отделения</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                  Вы уверены что желаете удалить отделение<span class="font-weight-bold"> "{{sBranchName}}"</span>?
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Нет</button>
                  <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="OnDeleteBranch()">Да</button>
                </div>
              </div>
            </div>
          </div>


        </div>
      </div>

      <div class="col-6">
        <h4 class="alert-primary py-2 pl-2">Редактирование пользователей</h4>
        <div class="card card-body mt-4">
          <ul class="list-group">
            <li [class.selected] = "uElem === selectedUser" class="list-group-item"  (click)="muUser(uElem)" *ngFor="let uElem of usersList">
              <span class="badge badge-secondary" *ngIf="uElem.filial===0">!</span>
              {{uElem.nick}}
              <button data-toggle="collapse" data-target="#collapseUserFrame" class="btn btn-primary float-right" type="button" title="задать права пользователю" (click)="changeUserRight(uElem)">
                <i class="fa fa-edit"></i>
              </button>

            </li>
          </ul>
        </div>

        <!--
        //TODO !!!!
        -->
        {{sError}}
        <div class="collapse" id="collapseUserFrame">

          <h4 class="alert-primary mt-2 py-2 pl-2">Настройка пользователя</h4>

          <div class="card card-body">
            <ul class="list-group">
              <li class="list-group-item">

                <!--     Поменял этот на красивый чек-бокс, строка 154

                   <div class="form-check">
                          <label class="form-check-label">
                            <input type="checkbox" formControlName="checkIP" class="form-check-input">
                            Проверять IP адрес
                          </label>
                        </div>
        -->
                <div class="custom-control custom-checkbox">
                  <input type="checkbox" class="custom-control-input" id="checkIP" formControlName="checkIP">
                  <label class="custom-control-label" for="checkIP">Проверять IP адрес</label>
                </div>

                <div class="input-group mb-3">
                  <div class="input-group-prepend">
                    <span class="input-group-text" id="basic-addon1">IP</span>
                  </div>
                  <input type="text" formControlName="ip" class="form-control" placeholder="127.0.0.1" aria-label="IP пользователя" aria-describedby="basic-addon1">
                </div>
              </li>
              <li class="list-group-item">

                <div class="input-group mb-3">
                  <div class="input-group-prepend">
                    <span class="input-group-text" id="basic-addon2">Группа</span>
                  </div>
                  <input type="text"  formControlName="chbranch" class="form-control" placeholder="Не назначен" aria-label="Не назначен" aria-describedby="basic-addon2">
                  <div class="dropdown">
                    <button class="btn btn-primary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    </button>
                    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                      <a class="dropdown-item" (click)="choiseBranchForUser(chBranch)" *ngFor="let chBranch of branchList">{{chBranch.name }}</a>
                    </div>
                  </div>
                </div>

              </li>

              <li class="list-group-item">

                <div class="input-group mb-3">
                  <div class="input-group-prepend">
                    <span class="input-group-text" id="basic-addon3">Ник</span>
                  </div>
                  <input type="text" formControlName="nick"  class="form-control" placeholder="Еще что забыл" aria-label="Еще что забыл" aria-describedby="basic-addon3">
                </div>

              </li>
            </ul>



            <button class="btn btn-outline-primary float-right" type="button"  data-toggle="collapse" data-target="#collapseChoiseBranch">Отвязать от филиала</button>
            <button class="btn btn-outline-primary float-right" type="button" data-toggle="collapse" data-target="#collapseDeleteUserAll">Удалить пользователя полностью</button>
            <button class="btn btn-outline-primary float-right" type="button" (click)="OnSaveAllUserBranch()">Сохранить</button>
            <button class="btn btn-outline-primary float-right" data-toggle="collapse" data-target="#collapseUserFrame" type="button">Отмена</button>


          </div>

        </div>

        <div *ngIf="this.chBranch"  class="collapse" id="collapseChoiseBranch">
          <div class="card card-body">
            <div class="alert alert-primary" role="alert">
              Вы уверены что желаете удалить связь с выбранным отделением {{this.chBranch.name}}?
            </div>
            <div class="input-group-append">
              <button class="btn btn-outline-primary float-right" type="button" (click)="OnDeleteUserBranch()">Да</button>
              <button class="btn btn-outline-primary float-right" data-toggle="collapse" data-target="#collapseChoiseBranch" type="button">Нет</button>
            </div>
          </div>
        </div>

        <div *ngIf="this.selectedUser"  class="collapse" id="collapseDeleteUserAll">
          <div class="card card-body">
            <div class="alert alert-primary" role="alert">
              Вы уверены что желаете полностью удалить пользователя {{this.selectedUser.nick}}?
            </div>

            <div class="input-group-append">
              <button class="btn btn-outline-primary float-right" type="button" (click)="OnDeleteUserFull()">Да</button>
              <button class="btn btn-outline-primary float-right" data-toggle="collapse" data-target="#collapseDeleteUserAll" type="button">Нет</button>
            </div>

          </div>
        </div>

      </div>
    </div>
  </form>

    <div class="row">
      <div class="col-6">
        <app-addwork-admin></app-addwork-admin>
      </div>
      <div class="col-6">
        <app-address-admin></app-address-admin>
      </div>
    </div>


</div>


